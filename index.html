<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Journey â€” Boba, Lola & Tota</title>
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<style>
  body{
    margin:0;
    font-family:Arial, sans-serif;
    color:white;
    background:url('https://images.unsplash.com/photo-1475274047050-1d0c0975c63e?q=80&w=1172&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D') center/cover no-repeat;
    background-size:cover;
  }
  header{
    padding:24px;
    text-align:center;
    background:rgba(0,0,0,0.4);
  }
  header h1{margin:0;color:#ff2d95;}
  header p{margin-top:6px;color:#ffdff3;font-size:0.9rem;}
  .grid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap:12px;
    max-width:1200px;
    margin:20px auto;
  }
  .photoCard{
    width:100%;
    aspect-ratio:1/1;
    border-radius:12px;
    overflow:hidden;
    cursor:pointer;
    background:#00000040;
    transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.6s ease;
    opacity:0;
    transform: translateY(20px);
  }
  .photoCard.visible{
    opacity:1;
    transform: translateY(0);
  }
  .photoCard:hover{
    transform: scale(1.08) translateY(-4px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.3);
  }
  .photoCard img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  #scenePanel{
    position:fixed;
    left:0;
    right:0;
    bottom:20px;
    display:flex;
    justify-content:center;
    gap:100px;
    align-items:flex-end;
    z-index:10;
  }
  .modelWrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    cursor:pointer;
    position:relative;
    width:90px;
  }
  .nameLabel{
    margin-bottom:4px;
    font-size:0.85rem;
    color:#ffeef3;
    text-align:center;
  }
  .bubble{
    position:absolute;
    bottom:120%;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,0.85);
    padding:6px 12px;
    border-radius:16px;
    font-size:0.9rem;
    display:none;
    white-space:nowrap;
    opacity:0;
    transition: opacity 0.4s ease;
    z-index:20;
  }
  .bubble.show{
    display:block;
    opacity:1;
  }
  .bubble::after{
    content:"";
    position:absolute;
    top:100%;
    left:50%;
    transform:translateX(-50%);
    border-width:6px;
    border-style:solid;
    border-color:rgba(0,0,0,0.85) transparent transparent transparent;
  }
  model-viewer{
    width:90px;
    height:90px;
    background:transparent;
    --poster-color: transparent;
  }
</style>
</head>
<body>
<header>
  <h1>Our Journey</h1>
  <p>Click a photo to write its story. Meet Boba, Lola & Tota below.</p>
</header>

<div class="grid" id="photoGrid"></div>

<div id="scenePanel">
  <div class="modelWrap" id="totaWrap">
    <div class="nameLabel">Tota</div>
    <model-viewer id="totaModel"
      src="assets/chibi_cat.glb"
      camera-controls auto-rotate alt="Tota Model">
    </model-viewer>
    <div class="bubble" id="totaBubble"></div>
  </div>
  <div class="modelWrap" id="bobaWrap">
    <div class="nameLabel">Boba</div>
    <model-viewer id="bobaModel"
      src="assets/chibi_astronaut.glb"
      camera-controls auto-rotate alt="Boba Model">
    </model-viewer>
    <div class="bubble" id="bobaBubble"></div>
  </div>
  <div class="modelWrap" id="lolaWrap">
    <div class="nameLabel">Lola</div>
    <model-viewer id="lolaModel"
      src="assets/chibi_dog.glb"
      camera-controls auto-rotate alt="Lola Model">
    </model-viewer>
    <div class="bubble" id="dogBubble"></div>
  </div>
</div>

<script>
  // --- PHOTO GRID ---
  const grid=document.getElementById('photoGrid');
  for(let i=1;i<=365;i++){
    const card=document.createElement('div');
    card.className='photoCard';
    const img=document.createElement('img');
    img.loading='lazy';
    img.src=`https://picsum.photos/seed/journey${i}/400/400`;
    img.alt=`Photo ${i}`;
    img.onclick=()=>location.href=`story.html?id=${i}`;
    card.appendChild(img);
    grid.appendChild(card);
  }
  const observer = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  },{threshold:0.1});
  document.querySelectorAll('.photoCard').forEach(card=>observer.observe(card));

  // --- Messages ---
  function typeMessage(el, text){
    el.textContent='';
    el.classList.add('show');
    let idx=0;
    const interval=setInterval(()=>{
      el.textContent+=text[idx];
      idx++;
      if(idx>=text.length) clearInterval(interval);
    },50);
    setTimeout(()=>el.classList.remove('show'),3000);
  }

  const bobaLines=[
    'I love you Tonaaa â™¥â™¥',
    'I am here with you my love â™¥âœ¨',
    'You are mine ok ?! ðŸ˜‰â™¥',
    'You are what I wish for â™¥â™¥',
    'I will always be here for you â™¥ðŸ«‚',
    'Eat well ok ? ðŸ˜ '
  ];
  let bIndex=0;
  const bobaBubble=document.getElementById('bobaBubble');
  let autoInterval;
  function showBoba(){ typeMessage(bobaBubble, bobaLines[bIndex]); bIndex=(bIndex+1)%bobaLines.length; }
  function startAutoBoba(){ autoInterval=setInterval(showBoba,5000); }
  startAutoBoba();
  document.getElementById('bobaWrap').addEventListener('click',()=>{
    clearInterval(autoInterval); showBoba(); startAutoBoba();
  });

  // Lola Messages
  const dogBubble=document.getElementById('dogBubble');
  let dogSilenceUntil=0;
  function showLola(msg){ typeMessage(dogBubble, msg); }
  function dogHaw(){ if(Date.now() < dogSilenceUntil) return; showLola('haw haw'); }
  setInterval(dogHaw,15000);
  setTimeout(dogHaw,1500);
  document.getElementById('lolaWrap').addEventListener('click', ()=>{
    dogSilenceUntil = Date.now() + 60000;
    showLola('â™¥');
  });

  // Tota Messages
  const totaBubble=document.getElementById('totaBubble');
  let totaSilenceUntil=0;
  function showTota(msg){ typeMessage(totaBubble, msg); }
  function totaMeow(){ if(Date.now() < totaSilenceUntil) return; showTota('meow'); }
  setInterval(totaMeow,15000);
  setTimeout(totaMeow,1500);
  document.getElementById('totaWrap').addEventListener('click', ()=>{
    totaSilenceUntil = Date.now() + 60000;
    showTota('â™¥');
  });

  // --- Rotate together ---
  let angle = 0;
  function rotateModels(){
    angle += 0.2;
    document.getElementById('bobaModel').style.transform = `rotateY(${angle}deg)`;
    document.getElementById('lolaModel').style.transform = `rotateY(${angle}deg)`;
    document.getElementById('totaModel').style.transform = `rotateY(${angle}deg)`;
    requestAnimationFrame(rotateModels);
  }
  rotateModels();

  // --- Face camera on click ---
  document.getElementById('bobaWrap').addEventListener('click',()=>{ document.getElementById('bobaModel').style.transform='rotateY(0deg)'; });
  document.getElementById('lolaWrap').addEventListener('click',()=>{ document.getElementById('lolaModel').style.transform='rotateY(0deg)'; });
  document.getElementById('totaWrap').addEventListener('click',()=>{ document.getElementById('totaModel').style.transform='rotateY(0deg)'; });

</script>
</body>
</html>
